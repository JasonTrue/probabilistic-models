apply plugin: 'scala'

repositories {
    mavenCentral()
}

dependencies {
    // Scala compiler and related tools
    scalaTools 'org.scala-lang:scala-compiler:2.9.2'
    scalaTools 'org.scala-lang:scala-library:2.9.2'

    // Scala standard library
    compile 'org.scala-lang:scala-library:2.9.2'

    testCompile 'org.scalatest:scalatest_2.9.0:1.9.1'
}


/*  The scala plugin doesn't support the popular Scalatest plugin explicitly yet
    so we call out to ant to run tests. Unfortunately, that means that we don't get the benefit of gradle's
    test report infrastructure for now.
 */
task test(overwrite: true, dependsOn: testClasses) << {
    ant.taskdef(name: 'scalatest',
            classname: 'org.scalatest.tools.ScalaTestAntTask',
            classpath: sourceSets.test.runtimeClasspath.asPath
    )
    ant.scalatest(runpath: sourceSets.test.output.classesDir,
            haltonfailure: 'true',
            fork: 'false') {reporter(type: 'stdout')
    }
}